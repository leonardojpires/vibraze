// Lista de palavras dispon√≠veis para o modo solo, cada uma com um tema associado
const palavrasTemas = [
    { palavra: "ELEFANTE", tema: "Animal" },
    { palavra: "BRASIL", tema: "Pa√≠s" },
    { palavra: "COMPUTADOR", tema: "Tecnologia" },
    { palavra: "PIZZA", tema: "Comida" },
    { palavra: "LUA", tema: "Espa√ßo" }
  ];

  // Vari√°veis globais do jogo
  let palavraSecreta = "";       // Armazena a palavra que o jogador deve adivinhar
  let tema = "";                 // Tema da palavra
  let letrasCorretas = [];       // Letras que o jogador acertou
  let letrasErradas = [];        // Letras ou palavras que o jogador errou

  // Inicia o modo solo, escolhendo uma palavra aleat√≥ria da lista
  function iniciarJogoSolo() {
    const sorteada = palavrasTemas[Math.floor(Math.random() * palavrasTemas.length)];
    palavraSecreta = sorteada.palavra;
    tema = sorteada.tema;
    iniciarJogo(); // Continua o fluxo para iniciar o jogo
  }

  // Exibe o formul√°rio para o segundo jogador digitar a palavra e o tema
  function mostrarFormularioDoisJogadores() {
    document.getElementById("formDoisJogadores").classList.remove("d-none");
  }

  // Inicia o jogo no modo dois jogadores com a palavra digitada
  function iniciarJogoDoisJogadores() {
    const palavra = document.getElementById("palavraJogador").value.toUpperCase(); // Converte para mai√∫sculas
    const temaInput = document.getElementById("temaJogador").value;
    if (!palavra || !temaInput) return alert("Preencha a palavra e o tema!");

    palavraSecreta = palavra;
    tema = temaInput;
    iniciarJogo();
  }

  // Inicializa as vari√°veis e configura a interface do jogo
  function iniciarJogo() {
    letrasCorretas = [];
    letrasErradas = [];

    // Esconde sele√ß√µes de modo e mostra o jogo
    document.getElementById("modoSelecao").classList.add("d-none");
    document.getElementById("formDoisJogadores").classList.add("d-none");
    document.getElementById("jogo").classList.remove("d-none");

    // Atualiza o tema na interface e limpa mensagens anteriores
    document.getElementById("temaAtual").textContent = tema;
    document.getElementById("mensagem").textContent = "";

    // Habilita o campo de entrada e foca nele
    document.getElementById("entrada").disabled = false;
    document.getElementById("entrada").focus();

    // Atualiza os elementos visuais do jogo
    atualizarEspacos();
    atualizarLetrasDigitadas();
    atualizarCanvas();
  }

  // Mostra os espa√ßos da palavra com as letras corretas reveladas
  function atualizarEspacos() {
    const container = document.getElementById("espacos");
    container.innerHTML = ""; // Limpa conte√∫do anterior

    for (let letra of palavraSecreta) {
      const span = document.createElement("span");
      span.textContent = letrasCorretas.includes(letra) ? letra : ""; // Mostra letra se acertada
      container.appendChild(span);
    }
  }

  // Processa a tentativa do jogador (letra ou palavra)
  function tentarLetra() {
    if (event) event.preventDefault(); // Impede o envio do formul√°rio (recarregamento da p√°gina)

    const input = document.getElementById("entrada");
    const tentativa = input.value.toUpperCase().trim(); // Converte para mai√∫sculas e remove espa√ßos
    input.value = ""; // Limpa o campo ap√≥s a tentativa

    // Se n√£o for uma letra ou palavra v√°lida (somente A-Z), ignora
    if (!tentativa.match(/^[A-Z]+$/)) return;

    // Tentativa de palavra inteira
    if (tentativa.length > 1) {
      if (tentativa === palavraSecreta) {
        // Acertou a palavra inteira: adiciona todas as letras como corretas (sem duplicar)
        letrasCorretas = [...new Set(palavraSecreta)];
        atualizarEspacos();
        mostrarModal("üéâ Parab√©ns!", "Acertaste a palavra inteira!");
        desabilitarJogo();
      } else {
        // Palavra errada: conta como erro, mas n√£o penaliza repeti√ß√£o
        if (!letrasErradas.includes(tentativa)) letrasErradas.push(tentativa);
        atualizarEstadoJogo();
      }
      return;
    }

    // Tentativa de uma letra
    const letra = tentativa;

    // Ignora se j√° foi tentada antes (acertada ou errada)
    if (letrasCorretas.includes(letra) || letrasErradas.includes(letra)) return;

    // Verifica se a letra est√° na palavra
    if (palavraSecreta.includes(letra)) {
      letrasCorretas.push(letra);
    } else {
      letrasErradas.push(letra);
    }

    atualizarEstadoJogo();
  }

  // Atualiza contadores, letras erradas, espa√ßos e canvas
  function atualizarEstadoJogo() {
    document.getElementById("erros").textContent = letrasErradas.length;
    atualizarEspacos();
    atualizarLetrasEscritas();
    atualizarCanvas();
    verificarFimDeJogo();
  }

  // Atualiza a lista vis√≠vel de letras e palavras erradas
  function atualizarLetrasEscritas() {
    document.getElementById("letrasEscritas").textContent = letrasErradas.join(", ");
  }

  // Verifica se o jogo foi vencido ou perdido
  function verificarFimDeJogo() {
    // Verifica se todas as letras da palavra foram adivinhadas
    const venceu = [...new Set(palavraSecreta)].every(l => letrasCorretas.includes(l));

    if (venceu) {
      mostrarModal("üéâ Parab√©ns!", "Venceste!");
      desabilitarJogo();
    } else if (letrasErradas.length >= 6) {
      mostrarModal("üò¢ Que pena!", `Perdeste! A palavra era "<strong>${palavraSecreta}</strong>".`);
      desabilitarJogo();
    }
  }

  // Mostra um modal de resultado (vit√≥ria ou derrota)
  function mostrarModal(titulo, mensagem) {
    document.getElementById("resultadoTitulo").textContent = titulo;
    document.getElementById("resultadoMensagem").innerHTML = mensagem;
    new bootstrap.Modal(document.getElementById("resultadoModal")).show();
  }

  // Desativa o campo de entrada ap√≥s o fim do jogo
  function desabilitarJogo() {
    document.getElementById("entrada").disabled = true;
  }

  function desenharEstruturaForca(ctx) {
    ctx.strokeStyle = "#000";
    ctx.lineWidth = 2;

    ctx.beginPath();
    ctx.moveTo(10, 230); ctx.lineTo(190, 230); // base
    ctx.moveTo(50, 230); ctx.lineTo(50, 20);   // poste vertical
    ctx.lineTo(130, 20); ctx.lineTo(130, 40);  // parte superior e gancho
    ctx.stroke();
  }

  // Desenha a forca no canvas com base na quantidade de erros
  function atualizarCanvas() {
    const canvas = document.getElementById("forcaCanvas");
    const ctx = canvas.getContext("2d");
    ctx.clearRect(0, 0, canvas.width, canvas.height); // Limpa o canvas antes de redesenhar

    ctx.strokeStyle = "#000";
    ctx.lineWidth = 2;

    // Estrutura da forca (base, poste, topo, gancho)
    ctx.beginPath();
    ctx.moveTo(10, 230); ctx.lineTo(190, 230); // base
    ctx.moveTo(50, 230); ctx.lineTo(50, 20);   // poste vertical
    ctx.lineTo(130, 20); ctx.lineTo(130, 40);  // parte superior
    ctx.stroke();

    // Desenha partes do boneco conforme o n√∫mero de erros
    if (letrasErradas.length >= 1) { // Cabe√ßa
        // Inicia o desenho da cabe√ßa
        ctx.beginPath();
        // Desenha um c√≠rculo (a cabe√ßa) com centro em (130, 55) e raio 15
        ctx.arc(130, 55, 15, 0, Math.PI * 2);
        // Finaliza o desenho da linha/c√≠rculo
        ctx.stroke();
      }

      if (letrasErradas.length >= 2) { // Tronco
        // Inicia o desenho do tronco
        ctx.beginPath();
        // Move o ponto de in√≠cio para (130, 70), abaixo da cabe√ßa
        ctx.moveTo(130, 70);
        // Desenha uma linha do ponto (130, 70) at√© (130, 120), formando o tronco
        ctx.lineTo(130, 120);
        // Finaliza o desenho da linha
        ctx.stroke();
      }

      if (letrasErradas.length >= 3) { // Bra√ßo esquerdo
        // Inicia o desenho do bra√ßo esquerdo
        ctx.beginPath();
        // Move o ponto de in√≠cio para (130, 80), logo abaixo da cabe√ßa
        ctx.moveTo(130, 80);
        // Desenha uma linha do ponto (130, 80) at√© (110, 100), formando o bra√ßo esquerdo
        ctx.lineTo(110, 100);
        // Finaliza o desenho da linha
        ctx.stroke();
      }

      if (letrasErradas.length >= 4) { // Bra√ßo direito
        // Inicia o desenho do bra√ßo direito
        ctx.beginPath();
        // Move o ponto de in√≠cio para (130, 80), o mesmo local do bra√ßo esquerdo
        ctx.moveTo(130, 80);
        // Desenha uma linha do ponto (130, 80) at√© (150, 100), formando o bra√ßo direito
        ctx.lineTo(150, 100);
        // Finaliza o desenho da linha
        ctx.stroke();
      }

      if (letrasErradas.length >= 5) { // Perna esquerda
        // Inicia o desenho da perna esquerda
        ctx.beginPath();
        // Move o ponto de in√≠cio para (130, 120), logo abaixo do tronco
        ctx.moveTo(130, 120);
        // Desenha uma linha da posi√ß√£o (130, 120) at√© (110, 150), formando a perna esquerda
        ctx.lineTo(110, 150);
        // Finaliza o desenho da linha
        ctx.stroke();
      }

      if (letrasErradas.length >= 6) { // Perna direita
        // Inicia o desenho da perna direita
        ctx.beginPath();
        // Move o ponto de in√≠cio para (130, 120), mesma posi√ß√£o da perna esquerda
        ctx.moveTo(130, 120);
        // Desenha uma linha da posi√ß√£o (130, 120) at√© (150, 150), formando a perna direita
        ctx.lineTo(150, 150);
        // Finaliza o desenho da linha
        ctx.stroke();
      }

  }
 // Lista de palavras dispon√≠veis para o modo solo, cada uma com um tema associado
const palavrasTemas = [
    { palavra: "ELEFANTE", tema: "Animal" },
    { palavra: "BRASIL", tema: "Pa√≠s" },
    { palavra: "COMPUTADOR", tema: "Tecnologia" },
    { palavra: "PIZZA", tema: "Comida" },
    { palavra: "LUA", tema: "Espa√ßo" }
  ];

  // Vari√°veis globais do jogo
  let palavraSecreta = "";       // Armazena a palavra que o jogador deve adivinhar
  let tema = "";                 // Tema da palavra
  let letrasCorretas = [];       // Letras que o jogador acertou
  let letrasErradas = [];        // Letras ou palavras que o jogador errou

  // Inicia o modo solo, escolhendo uma palavra aleat√≥ria da lista
  function iniciarJogoSolo() {
    const sorteada = palavrasTemas[Math.floor(Math.random() * palavrasTemas.length)];
    palavraSecreta = sorteada.palavra;
    tema = sorteada.tema;
    iniciarJogo(); // Continua o fluxo para iniciar o jogo
  }

  // Exibe o formul√°rio para o segundo jogador digitar a palavra e o tema
  function mostrarFormularioDoisJogadores() {
    document.getElementById("formDoisJogadores").classList.remove("d-none");
  }

  // Inicia o jogo no modo dois jogadores com a palavra digitada
  function iniciarJogoDoisJogadores() {
    const palavra = document.getElementById("palavraJogador").value.toUpperCase(); // Converte para mai√∫sculas
    const temaInput = document.getElementById("temaJogador").value;
    if (!palavra || !temaInput) return alert("Preencha a palavra e o tema!");

    palavraSecreta = palavra;
    tema = temaInput;
    iniciarJogo();
  }

  // Inicializa as vari√°veis e configura a interface do jogo
  function iniciarJogo() {
    letrasCorretas = [];
    letrasErradas = [];

    // Esconde sele√ß√µes de modo e mostra o jogo
    document.getElementById("modoSelecao").classList.add("d-none");
    document.getElementById("formDoisJogadores").classList.add("d-none");
    document.getElementById("jogo").classList.remove("d-none");

    // Atualiza o tema na interface e limpa mensagens anteriores
    document.getElementById("temaAtual").textContent = tema;
    document.getElementById("mensagem").textContent = "";

    // Habilita o campo de entrada e foca nele
    document.getElementById("entrada").disabled = false;
    document.getElementById("entrada").focus();

    // Atualiza os elementos visuais do jogo
    atualizarEspacos();
    atualizarLetrasDigitadas();
    atualizarCanvas();
  }

  // Mostra os espa√ßos da palavra com as letras corretas reveladas
  function atualizarEspacos() {
    const container = document.getElementById("espacos");
    container.innerHTML = ""; // Limpa conte√∫do anterior

    for (let letra of palavraSecreta) {
      const span = document.createElement("span");
      span.textContent = letrasCorretas.includes(letra) ? letra : ""; // Mostra letra se acertada
      container.appendChild(span);
    }
  }

  // Processa a tentativa do jogador (letra ou palavra)
  function tentarLetra() {
    if (event) event.preventDefault(); // Impede o envio do formul√°rio (recarregamento da p√°gina)

    const input = document.getElementById("entrada");
    const tentativa = input.value.toUpperCase().trim(); // Converte para mai√∫sculas e remove espa√ßos
    input.value = ""; // Limpa o campo ap√≥s a tentativa

    // Se n√£o for uma letra ou palavra v√°lida (somente A-Z), ignora
    if (!tentativa.match(/^[A-Z]+$/)) return;

    // Tentativa de palavra inteira
    if (tentativa.length > 1) {
      if (tentativa === palavraSecreta) {
        // Acertou a palavra inteira: adiciona todas as letras como corretas (sem duplicar)
        letrasCorretas = [...new Set(palavraSecreta)];
        atualizarEspacos();
        mostrarModal("üéâ Parab√©ns!", "Acertaste a palavra inteira!");
        desabilitarJogo();
      } else {
        // Palavra errada: conta como erro, mas n√£o penaliza repeti√ß√£o
        if (!letrasErradas.includes(tentativa)) letrasErradas.push(tentativa);
        atualizarEstadoJogo();
      }
      return;
    }

    // Tentativa de uma letra
    const letra = tentativa;

    // Ignora se j√° foi tentada antes (acertada ou errada)
    if (letrasCorretas.includes(letra) || letrasErradas.includes(letra)) return;

    // Verifica se a letra est√° na palavra
    if (palavraSecreta.includes(letra)) {
      letrasCorretas.push(letra);
    } else {
      letrasErradas.push(letra);
    }

    atualizarEstadoJogo();
  }

  // Atualiza contadores, letras erradas, espa√ßos e canvas
  function atualizarEstadoJogo() {
    document.getElementById("erros").textContent = letrasErradas.length;
    atualizarEspacos();
    atualizarLetrasEscritas();
    atualizarCanvas();
    verificarFimDeJogo();
  }

  // Atualiza a lista vis√≠vel de letras e palavras erradas
  function atualizarLetrasEscritas() {
    document.getElementById("letrasEscritas").textContent = letrasErradas.join(", ");
  }

  // Verifica se o jogo foi vencido ou perdido
  function verificarFimDeJogo() {
    // Verifica se todas as letras da palavra foram adivinhadas
    const venceu = [...new Set(palavraSecreta)].every(l => letrasCorretas.includes(l));

    if (venceu) {
      mostrarModal("üéâ Parab√©ns!", "Venceste!");
      desabilitarJogo();
    } else if (letrasErradas.length >= 6) {
      mostrarModal("üò¢ Que pena!", `Perdeste! A palavra era "<strong>${palavraSecreta}</strong>".`);
      desabilitarJogo();
    }
  }

  // Mostra um modal de resultado (vit√≥ria ou derrota)
  function mostrarModal(titulo, mensagem) {
    document.getElementById("resultadoTitulo").textContent = titulo;
    document.getElementById("resultadoMensagem").innerHTML = mensagem;
    new bootstrap.Modal(document.getElementById("resultadoModal")).show();
  }

  // Desativa o campo de entrada ap√≥s o fim do jogo
  function desabilitarJogo() {
    document.getElementById("entrada").disabled = true;
  }

  function desenharEstruturaForca(ctx) {
    ctx.strokeStyle = "#000";
    ctx.lineWidth = 2;

    ctx.beginPath();
    ctx.moveTo(10, 230); ctx.lineTo(190, 230); // base
    ctx.moveTo(50, 230); ctx.lineTo(50, 20);   // poste vertical
    ctx.lineTo(130, 20); ctx.lineTo(130, 40);  // parte superior e gancho
    ctx.stroke();
  }

  // Desenha a forca no canvas com base na quantidade de erros
  function atualizarCanvas() {
    const canvas = document.getElementById("forcaCanvas");
    const ctx = canvas.getContext("2d");
    ctx.clearRect(0, 0, canvas.width, canvas.height); // Limpa o canvas antes de redesenhar

    ctx.strokeStyle = "#000";
    ctx.lineWidth = 2;

    // Estrutura da forca (base, poste, topo, gancho)
    ctx.beginPath();
    ctx.moveTo(10, 230); ctx.lineTo(190, 230); // base
    ctx.moveTo(50, 230); ctx.lineTo(50, 20);   // poste vertical
    ctx.lineTo(130, 20); ctx.lineTo(130, 40);  // parte superior
    ctx.stroke();

    // Desenha partes do boneco conforme o n√∫mero de erros
    if (letrasErradas.length >= 1) { // Cabe√ßa
        // Inicia o desenho da cabe√ßa
        ctx.beginPath();
        // Desenha um c√≠rculo (a cabe√ßa) com centro em (130, 55) e raio 15
        ctx.arc(130, 55, 15, 0, Math.PI * 2);
        // Finaliza o desenho da linha/c√≠rculo
        ctx.stroke();
      }

      if (letrasErradas.length >= 2) { // Tronco
        // Inicia o desenho do tronco
        ctx.beginPath();
        // Move o ponto de in√≠cio para (130, 70), abaixo da cabe√ßa
        ctx.moveTo(130, 70);
        // Desenha uma linha do ponto (130, 70) at√© (130, 120), formando o tronco
        ctx.lineTo(130, 120);
        // Finaliza o desenho da linha
        ctx.stroke();
      }

      if (letrasErradas.length >= 3) { // Bra√ßo esquerdo
        // Inicia o desenho do bra√ßo esquerdo
        ctx.beginPath();
        // Move o ponto de in√≠cio para (130, 80), logo abaixo da cabe√ßa
        ctx.moveTo(130, 80);
        // Desenha uma linha do ponto (130, 80) at√© (110, 100), formando o bra√ßo esquerdo
        ctx.lineTo(110, 100);
        // Finaliza o desenho da linha
        ctx.stroke();
      }

      if (letrasErradas.length >= 4) { // Bra√ßo direito
        // Inicia o desenho do bra√ßo direito
        ctx.beginPath();
        // Move o ponto de in√≠cio para (130, 80), o mesmo local do bra√ßo esquerdo
        ctx.moveTo(130, 80);
        // Desenha uma linha do ponto (130, 80) at√© (150, 100), formando o bra√ßo direito
        ctx.lineTo(150, 100);
        // Finaliza o desenho da linha
        ctx.stroke();
      }

      if (letrasErradas.length >= 5) { // Perna esquerda
        // Inicia o desenho da perna esquerda
        ctx.beginPath();
        // Move o ponto de in√≠cio para (130, 120), logo abaixo do tronco
        ctx.moveTo(130, 120);
        // Desenha uma linha da posi√ß√£o (130, 120) at√© (110, 150), formando a perna esquerda
        ctx.lineTo(110, 150);
        // Finaliza o desenho da linha
        ctx.stroke();
      }

      if (letrasErradas.length >= 6) { // Perna direita
        // Inicia o desenho da perna direita
        ctx.beginPath();
        // Move o ponto de in√≠cio para (130, 120), mesma posi√ß√£o da perna esquerda
        ctx.moveTo(130, 120);
        // Desenha uma linha da posi√ß√£o (130, 120) at√© (150, 150), formando a perna direita
        ctx.lineTo(150, 150);
        // Finaliza o desenho da linha
        ctx.stroke();
      }

  }
